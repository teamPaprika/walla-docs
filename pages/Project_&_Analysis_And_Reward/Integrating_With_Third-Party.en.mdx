import {Callout, Steps} from 'nextra/components'

## Integrating with Google Sheet

- Sync Walla with Google Sheets for real-time response tracking with our 'Google Sheets Integration' feature.

<Steps>
    ### Choose your project, go to the 'Integration' page, and click 'Connect with Google Sheets'.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F0.png)

    ### Google Sheets has been connected! Access the file with provided link.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F1.png)

    ### View real-time responses through the linked Google Sheets.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F2.png)

</Steps>

<Callout type='error' emoji="ðŸš¨">**In the 'Google Sheets Integration' feature, please note that Paprika Datalab owns the linked sheet. If you wish to link collected data with a company owned tools and accounts, you can use 'Webhooks' feature to connect with your existing tools. Refer to the '[Survey Form Webhook Guidelines](https://home.walla.my/blog-global/webhook-guideline-eng)' for instructions.**</Callout>

## Email Real-Time Notification

- Enable email notifications for instant response alerts.

<Steps>
    ### Choose your project, go to 'Integration,' and click 'Email Integration.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F3.png)

    ### Select the email address for notifications.
    - Only invited workspace accounts can receive email notifications.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F4.png)

    ### When a response is submitted, you will receive a notification via email like the one below.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F5.png)

</Steps>

## Integrating with Zapier

- Integrating with Zapier allows you to receive notifications from various services when responses arrives.
- Walla is supported on Zapier with the following tools:

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F6.png)

<Steps>

    ### To connect with Zapier and tool integrations, select the tool in "Integrations," login to Zapier, and set up your workflow.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F7.png)

    ### In the "App & Event" section of Zapier, choose "Walla Form" as the app and select "New Response" as the event.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F8.png)

    ### In the "Account" section, set up your Walla account that you want to connect.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F9.png)

    ### Choose the project you want to connect the responses to.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F10.png)

    ### Choose the service to connect to your account.

    ![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F11.png)

</Steps>

<Callout type='info' emoji="ðŸ””">**To automatically send emails to respondents with specific information upon Walla response, utilize features like 'Gmail integration' in Zapier.**</Callout>

## Integrating with Webhook

<Callout type='info' emoji="ðŸ””">**You can receive notifications or get various information related to surveys by integrating with other services when a response is received through webhooks.**</Callout>

### Integrating with Discord

#### 1. Go to 'Channel Settings' of the Discord server where you want to receive notifications.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F12.png)

#### 2. Click on 'Integrations' tab and then 'Webhooks'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F13.png)

#### 3. Click 'Copy Webhook URL'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F14.png)

#### 4. Go to the 'Integrate' tab in Walla and click on 'Manage Webhooks'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F15.png)

#### 5. Paste the URL copied from Discord and click 'Add Webhook'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F16.png)

#### 6. Change the `Header Name` value to `Content-Type` and `Value` to `application/json`.

<Callout type='info' emoji="ðŸ””">**If you want to receive notifications for 'Rejections' instead of 'Submission', change the webhook type to Reject.**</Callout>

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F17.png)

#### 7. Activate the Body settings and refer to the preset below to freely compose the content you want to receive on Discord.

- Write the content you want between the double quotes according to the format below.

- If you want to receive response details, paste `{{res:~~}}` from the preset.
- If you have set hidden fields, you can also receive the hidden field content in the notification.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F18.png)

#### 8. Save the changes and activate it in 'Webhook Settings'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F19.png)

#### 9. You will receive notifications on Discord when a response arrives.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F20.png)

### Integrating with Slack

#### 1. Go to https://api.slack.com/start/quickstart and click 'Go to Your Apps'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F21.png)

#### 2. Click 'Create an App'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F22.png)

#### 3. Click 'From scratch'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F23.png)

#### 4. Enter the webhook name and select the Slack workspace where you want to receive notifications.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F24.png)

#### 5. Click on 'Incoming Webhooks'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F25.png)

#### 6. Enable the use of webhooks.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F26.png)

#### 7. Click 'Add New Webhook to Workspace'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F27.png)

#### 8. Select the channel to receive notifications.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F28.png)

#### 9. Copy the completed webhook URL.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F29.png)

#### 10. Go to the 'Integrate' tab in Walla and click 'Manage Webhooks'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F30.png)

#### 11. Paste the URL copied from Slack and click 'Add Webhook'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F31.png)

#### 12. Change the `Header Name` value to `Content-Type` and `Value` to `application/json`.

<Callout type='info' emoji="ðŸ””">**If you want to receive notifications for 'Rejections' instead of 'Submission', change the webhook type to Reject.**</Callout>

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F32.png)

#### 13. Activate the Body settings and refer to the preset below to freely compose the content you want to receive on Slack.
- Write the content you want between the double quotes according to the format below.

```json
{
    "text": "Write your content here."
}
```

- If you want to receive response details, paste `{{res:~~}}` from the preset.

- If you have set hidden fields, you can also receive the hidden field content in the notification.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F33.png)

#### 14. Save the changes and activate it in 'Webhook Settings'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F34.png)

#### 15. In the 'Install App' tab, click 'Reinstall to Workspace' to reinstall the webhook.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F35.png)

#### 16. Select the channel to receive notifications.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F36.png)

#### 17. You will receive notifications on Slack when a response arrives.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F37.png)

### Integrating with Email

#### 1. Go to https://script.google.com/ and click 'New Project'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F38.png)

#### 2. Delete all the default content and paste the code below.

- For the `"------@------.---"` part of the code, enter the email address to receive notifications within the quotes.
    - e.g., `"minsu@walla.my, yeonghee@walla.my"`

- For the `<${FORM_TITLE}> ------------` part of the code, enter the subject of the email.
    - e.g., e.g., `<${FORM_TITLE}> New response submitted`

```javascript
function doPost(e) {
  var data = JSON.parse(e.postData.contents);
  var formAnswers = data.form_answers;
  var submittedAt = new Date(data.form_response.submitted_at);

  var formattedDate = Utilities.formatDate(submittedAt, "Asia/Seoul", "yyyy-MM-dd HH:mm:ss");
  var FORM_TITLE= data.form_definition.title;
  var PROJECT_KEY= data.form_definition.id;
  var emailBody = `<html>
  <body>
    <h3>New response is submitted.</h3>
    <p>A new response was submitted to your project "${FORM_TITLE}".</p>
    <p>Response ID: ${data.form_response.response_id}</p>
    <p>Submitted at: ${formattedDate}</p>`;

  formAnswers.forEach(function(field) {
    var question = field.label;
    var answer = getAnswerString(field);
    emailBody += `<h4>${question}</h4><p>${answer}</p>`;
  });

  emailBody += `</body></html>`;

  var recipientEmail = "------@------.---";
  var subject = `<${FORM_TITLE}> ------------`;
  var advancedOptions = {
    htmlBody: emailBody,
    charset: "UTF-8"
  };
  GmailApp.sendEmail(recipientEmail, subject, "", advancedOptions);

  return ContentService.createTextOutput(JSON.stringify({result: "success"})).setMimeType(ContentService.MimeType.JSON);
}

function getAnswerString(field) {
  switch (field.type) {
    case 'CHECKBOX':
    case 'RADIO':
      return Array.isArray(field.response) ? field.response.join(', ') : field.response;
    case 'CHECKBOX_GRID':
    case 'RADIO_GRID':
      return field.response.map(el => el.lineResponse.join(', ')).join('; ');
    case 'GEOLOCATION':
      return Object.entries(field.response || {}).map(([key, value]) => `${key}: ${value}`).join(', ');
    case 'HIDDEN':
      return field.response || '';
    default:
      return Array.isArray(field.response) ? field.response.join(', ') : field.response;
  }
}
```

#### 3. Click 'New Deployment'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F39.png)

#### 4. Set the type to 'Web App' and the user access to 'Anyone'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F40.png)

#### 5. Authorize access.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F41.png)

#### 6. Select the email address to be the sender.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F42.png)

#### 7. Copy the 'URL'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F43.png)

#### 8. Go to the 'Integrate' tab in Walla and click 'Manage Webhooks'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F44.png)

#### 9. Paste the URL and add the webhook.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F45.png)

#### 10. Save the changes and activate it in 'Webhook Settings'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F46.png)

#### 11. You will receive notifications by email when a response arrives.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F47.png)

### Integrating with Google Sheets

#### 1. In Google Sheets, go to the 'Extensions' tab and click 'Apps Script'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F48.png)

#### 2. Add a new script.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F49.png)

#### 3. Delete all the default content and paste the code below.

```javascript
function doPost(e) {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheets()[0];
  ss.setSpreadsheetTimeZone('Asia/Seoul');
  var data = JSON.parse(e.postData.contents);
  var formAnswers = data.form_answers;
  var submittedAt = new Date(data.form_response.submitted_at);

  var responseId = data.form_response.response_id.slice(0, 10);
  if (sheet.getLastRow() === 0) {
    var fieldLabels = formAnswers.map(function(answer) {
      if (answer.type === 'RADIO_GRID' || answer.type === 'CHECKBOX_GRID') {
        return answer.response.map(el => `${answer.label} - ${el.lineLabel}`);
      }
      return answer.label;
    }).flat();
    var headers = ['Response ID', 'Time Submitted', ...fieldLabels];
    sheet.appendRow(headers);
  }
  var rowData = formAnswers.map(field => {
    switch (field.type) {
      case 'CHECKBOX':
      case 'RADIO': {
        var isResponseArray = Array.isArray(field.response);
        if (isResponseArray) {
          return field.response.filter(el => Boolean(el)).join(', ');
        }
        return field.response || '';
      }
      case 'CHECKBOX_GRID':
      case 'RADIO_GRID': {
        var isLineResponseArray = Array.isArray(field.response.lineResponse);
        return field.response.map(el => {
          if (isLineResponseArray) {
            return el.lineResponse.filter(el => Boolean(el)).join(', ');
          }
          return el.lineResponse || '';
        });
      }
      case 'GEOLOCATION': {
        var response = field.response || {};
        var responseArray = Object.entries(response).map(el => `${el[0]}: ${el[1]}`);
        return responseArray.join(', ');
      }
      case 'HIDDEN': {
        return field.response === undefined || field.response === null
          ? ''
          : field.response;
      }
      default: {
        var response =
          field.response === undefined || field.response === null ? '' : field.response;
        if (Array.isArray(response)) {
          return response.join(', ');
        }
        return response;
      }
    }
  }).flat();
  sheet.appendRow([responseId, submittedAt, ...rowData]);
  return ContentService.createTextOutput(JSON.stringify({ result: 'success' })).setMimeType(ContentService.MimeType.JSON);
}
```

#### 4. Click 'New Deployment'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F50.png)

#### 5. Set the type to 'Web App' and the user access to 'Anyone'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F51.png)

#### 6. Authorize access.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F52.png)

#### 7. Copy the 'URL'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F53.png)

#### 8. Go to the 'Integrate' tab in Walla and click 'Manage Webhooks'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F54.png)

#### 9. Paste the URL and add the webhook.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F55.png)

#### 10. Save the changes and activate it in 'Webhook Settings'.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F56.png)

#### 11. You will receive notifications in Google Sheets when a response arrives.

![Untitled](https://paprikastorage.com/images%2FintegratingWithThirdParty%2Fen%2F57.png)

<Callout type='info' emoji="ðŸ””">
    Do you want to check Walla's future development plans or suggest new features? <br/>Click <a
    href='https://app.walla.my/signin?redirectUrl=/support/featureRequest'
    target="_blank"
    rel="noopener noreferrer"
    style={{textDecoration: 'underline'}}>**Product
    Roadmap and Feature Suggestions**</a>
</Callout>